package.name = "asterinas"

# Execution Sequence
[tag.PostToFunc]
args = [ "func" ]
desc = "This function should be executed after {func}."

[tag.NotPostToFunc]
args = [ "func" ]
desc = "This function should not be executed after {func}."

[tag.NotPriorToFunc]
args = [ "func" ]
types = [ "hazard" ]
desc = "This function should not be executed before {func}."

[tag.CallOnce]
args = [ "scope" ]
desc = "This function should be called only once per {scope}."

[tag.Context]
args = [ "after", "before" ]
desc = "This function should be executed after {after} before {before}."

# Data Dependency
[tag.OriginateFrom]
args = [ "val", "func" ]
desc = "{val} should originate from {func}."

#Value
[tag.Eq]
args = [ "lhs", "rhs"]
desc = "{lhs} should be equal to {rhs}."

[tag.Ne]
args = [ "lhs", "rhs"]
desc = "{lhs} should not be equal to {rhs}."

[tag.Ge]
args = [ "lhs", "rhs" ]
desc = "{lhs} should be greater than or equal to {rhs}."

#Valid
[tag.Valid]
args = [ "val" ]
desc = "{val} should be valid."

[tag.ValidAccessAddr]
args = [ "val", "access" ]
desc = "{val} should be valid for {access}."

[tag.ValidBaseAddr]
args = [ "val", "something" ]
desc = "{val} should be a valid base address of {something}."

[tag.ValidInstance]
args = [ "val", "something" ]
desc = "{val} should be a valid instance of {something}."

#Reference
[tag.RefHeld]
args = [ "val" ]
desc = "The caller must have already held a reference to {val}."

[tag.RefUnheld]
args = [ "val" ]
desc = "The caller must not hold the reference to {val}."

[tag.RefForgotten]
args = [ "val" ]
desc = "{val} must be forgotten by [`core::mem::forget`], [`ManuallyDrop`], or [`into_raw`]."

[tag.OwnedResource]
args = [ "val" ]
desc = "{val} shoule be exclusively owned."

#Memory
[tag.UserSpace]
args = [ "start", "end" ]
desc = "{start}..{end} should be within user space."

[tag.KernelMemorySafe]
args = [ "val" ]
types = [ "hazard" ]
desc = "{val} should not affect kernel's memory safety."

[tag.Section]
args = [ "val", "section" ]
types = [ "hazard" ]
dsec = "{val} should reside in {section}."

#Misc
[tag.MutAccess]
args = [ "val" ]
types = [ "hazard" ]
desc = "The caller should have exclusive mutable access to {val}."

[tag.NonModifying]
args = [ "val" ]
types = [ "hazard" ]
desc = "{val} should not be modified after calling the function."

[tag.Unaccessed]
args = [ "val" ]
desc = "{val} should bot be accessed."

[tag.Bounded]
args = [ "val", "bound" ]
desc = "{val} should be bounded by {bound}."

[tag.LockHeld]
args = [ "val" ]
desc = "{val} should have already held the lock."

[tag.ReferTo]
args = [ "func" ]
desc = "This function should meet the safety requirement of {func}."

[tag.Sync]
args = [ "val" ]
types = [ "hazard" ]
desc = "If the type of {val} is not [`Sync`], the caller must ensure that {val} is not accessed concurrently."

[tag.Memo]
args = [ "desc" ]
desc = "{desc}"